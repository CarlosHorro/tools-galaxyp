<tool id="metaquantome_expand" name="MetaQuantome Expand" version="@VERSION@.0">
    <description>annotated functional or taxonomy terms to include all terms</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements" />
    <command detect_errors="exit_code"><![CDATA[
        mkdir -p data && #slurp
        @MAKE_SAMPS_TSV@
        metaquantome expand
        @COMMON_PARAMS@
        @DB_DIR@
        #if $input.input_type == 'nopep':
            --nopep --nopep_file='$input.nopep_file' 
        #else:
            --int_file='$input.int_file' 
            --pep_colname_int='$input.pep_colname_int'
        #end if
       --outfile='$outfile'
    ]]></command>
    <inputs>
        <expand macro="data_dir"/>
        <expand macro="common_params"/>
        <conditional name="input">
            <param name="input_type" type="select" label="Select input data">
                <option value="int">tabular intensity file with peptide column</option>
                <option value="nopep">file without a peptide column</option>
            </param>
            <when value="int">
                <param argument="--int_file" type="data" format="tabular" label="intensity data"
                    help=""/>
                <param argument="--pep_colname_int" type="text" value="" label="Peptide column name" 
                    help="The column name within the intensity file that corresponds to the peptide sequences">
                    <validator type="empty_field"/>
                </param>
            </when>
            <when value="nopep">
                <param argument="--nopep_file" type="data" format="tabular" label="intensity data"
                    help=""/>
            </when>
        </conditional>
        <expand macro="output_samples_choice"/>
    </inputs>
    <outputs>
        <data format="tabular" name="outfile" label="${tool.name} on ${on_string} expanded"/>
        <expand macro="output_samples"/>
    </outputs>
    <tests>
        <test>
            <!-- expand('f', sinfo=TTEST_SINFO, int_file=int, pep_colname_int='peptide', pep_colname_func='peptide',
                         pep_colname_tax='peptide', data_dir=GO_TEST_DIR, outfile=expanded, func_file=func,
                         func_colname='go', ontology='go') -->
             <param name="int_file" value="int_ttest.tab" ftype="tabular"/>
             <param name="pep_colname_int" value="peptide" />
             <param name="func_file" value="multiple_func.tab" />
             <param name="pep_colname_func" value="peptide" />
             <param name="func_colname" value="go"/>
             <param name="mode" value="f" />
             <param name="ontology" value="go" />
             <param name="samps_src" value="build" />
             <repeat name="samps">
                 <param name="group_name" value="s1"/>
                 <param name="col_names" value="int1,int2,int3"/>
             </repeat>
             <repeat name="samps">
                 <param name="group_name" value="s2"/>
                 <param name="col_names" value="int4,int5,int6"/>
             </repeat>
             <output name="outfile" file="go_expanded.tab" ftype="tabular"/>
        </test>
    </tests>
    <help><![CDATA[
        help
    ]]></help>
    <expand macro="citations" />
</tool>
