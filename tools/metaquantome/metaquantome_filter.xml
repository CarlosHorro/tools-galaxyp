<tool id="metaquantome_filter" name="MetaQuantome Filter" version="@VERSION@.0">
    <description>for quality, redundancy, and sample coverage</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements" />
    <command detect_errors="exit_code"><![CDATA[
        @MAKE_SAMPS_TSV@
        metaquantome filter
        @COMMON_PARAMS@
        --expand_file '$expand_file'
        --min_peptides $min_peptides 
        #if $min_pep_nsamp:
            --min_pep_nsamp max($min_peptides,$min_pep_nsamp)
        #else
            --min_pep_nsamp all
        #end if
        --min_children_non_leaf $min_children_non_leaf
        #if $min_child_nsamp:
            --min_child_nsamp max($min_peptides,$min_child_nsamp)
        #else
            --min_child_nsamp all
        #end if
        --qthreshold $qthreshold
        --outfile='$output'
    ]]></command>
    <inputs>
        <expand macro="common_params"/>
        <param argument="--expand_file" type="data" format="tabular" label="metaquantome expand file"
                    help=""/>
        <param argument="--min_peptides" type="integer" value="0" min="0" label="min_peptides">
            <help>
                Used for filtering to well-supported annotations. The
                number of peptides providing evidence for a term is
                the number of peptides directly annotated with that
                term plus the number of peptides annotated with any of
                its descendants. Terms with a number of peptides
                greater than or equal to min_peptides are retained.
                The default is 0.
            </help>
        </param>
        <param argument="--min_pep_nsamp" type="integer" value="" min="0" optional="true" label="min_pep_nsamp">
            <help>
                Number of samples per group that must meet or exceed
                min_peptides. Default is 'all'.
            </help>
        </param>
        <param argument="--min_children_non_leaf" type="integer" value="0" min="0" label="min_children_non_leaf">
            <help>
                Used for filtering to informative annotations. A term
                is retained if it has a number of children greater
                than or equal to min_children_non_leaf. The default is 0.
            </help>
        </param>
        <param argument="--min_child_nsamp" type="integer" value="" min="0" optional="true" label="min_child_nsamp">
            <help>
                Number of samples per group that must meet or exceed
                min_children_nsamp. Default is 'all'.
            </help>
        </param>
        <param argument="--qthreshold" type="integer" value="3" min="0" label="qthreshold">
            <help>
                Minimum number of intensities in each sample group.
                Any functional/taxonomic term with lower number of
                per-group intensities will be filtered out. The
                default is 3, because this is the minimum number for
                t-tests.
            </help>
        </param>

        <expand macro="output_samples_choice"/>
    </inputs>
    <outputs>
        <data format="tabular" name="outfile" label="${tool.name} on ${on_string} filtered"/>
        <expand macro="output_samples"/>
    </outputs>
    <help><![CDATA[
        TODO: Fill in help.
    ]]></help>
    <expand macro="citations" />
</tool>
