--- PSMFeatureExtractor.xml.orig	2021-02-16 16:30:38.919393993 +0100
+++ PSMFeatureExtractor.xml	2021-02-16 16:32:34.862390198 +0100
@@ -17,6 +17,11 @@
 
 ## Preprocessing
 mkdir in &&
+#if $in
+${ ' '.join(["ln -s '%s' 'in/%s.%s' &&" % (_, re.sub('[^\w\-_]', '_', _.element_identifier), $gxy2omsext(_.ext)) for _ in $in if _]) }
+#else if $in_single
+ln -s '$in_single' 'in/${re.sub("[^\w\-_]", "_", $in_single.element_identifier)}.$gxy2omsext($in_single.ext)' &&  
+#end if
 mkdir ${' '.join(["'in/%s'" % (i) for i, f in enumerate($in) if f])} && 
 ${' '.join(["ln -s '%s' 'in/%s/%s.%s' && " % (f, i, re.sub('[^\w\-_]', '_', f.element_identifier), $gxy2omsext(f.ext)) for i, f in enumerate($in) if f])}
 mkdir out &&
@@ -28,7 +33,11 @@
 python3 '$__tool_directory__/fill_ctd.py' '@EXECUTABLE@.ctd' '$args_json' '$hardcoded_json' &&
 @EXECUTABLE@ -ini @EXECUTABLE@.ctd
 -in
+#if $in
 ${' '.join(["'in/%s/%s.%s'"%(i, re.sub('[^\w\-_]', '_', f.element_identifier), $gxy2omsext(f.ext)) for i, f in enumerate($in) if f])}
+#else if $in_single
+'in/${re.sub("[^\w\-_]", "_", $in_single.element_identifier)}.$gxy2omsext($in_single.ext)'
+#end if
 -out
 'out/output.${out_type}'
 
@@ -42,7 +51,8 @@
     <configfile name="hardcoded_json"><![CDATA[{"log": "log.txt", "threads": "\${GALAXY_SLOTS:-1}", "no_progress": true}]]></configfile>
   </configfiles>
   <inputs>
-    <param name="in" argument="-in" type="data" format="idxml,mzid" multiple="true" optional="false" label="Input file(s)" help=" select idxml,mzid data sets(s)"/>
+    <param name="in_single" argument="-in" type="data" format="idxml,mzid" multiple="false" optional="true" label="Input file for batch processing" help="(exactly one of -in or -in_list is required)"/>
+    <param name="in" argument="-in" type="data" format="idxml,mzid" multiple="true" optional="true" label="Input file(s) for joint processing" help="(exactly one of -in or -in_list is required)"/>   
     <param name="out_type" argument="-out_type" display="checkboxes" type="select" optional="false" label="Output file type -- default: determined from file extension or content" help="">
       <option value="idXML">idxml</option>
       <option value="mzid">mzid</option>
