<tool id="pmd_fdr" name="PMD FDR" version="0.1.0">
    <description>recalculate FDR fom precursor mass discrepancy</description>
    <requirements>
        <requirement type="package" version="">R</requirement>
        <requirement type="package" version="">r-stringr</requirement>
        <requirement type="package" version="">r-argparser</requirement>
        <requirement type="package" version="">r-codetools</requirement>
        <requirement type="package" version="">r-runit</requirement>
    </requirements>
    <stdio>
        <exit_code range="1:" />
    </stdio>
    <command><![CDATA[
        Rscript '${__tool_directory__}/PMD_FDR_package_for_Galaxy.R' 
        --psm_report '$psm_report'
        #if $psm_report_1_percent:
          --psm_report_1_percent '$psm_report_1_percent'
        #end if
        --input_file_type $input_file_type 
        --score_field_name "$score_field_name"
        --output_g_fdr '$output_g_fdr'
        --output_i_fdr '$output_i_fdr'
        --output_densities '$output_densities'
    ]]></command>
    <inputs>
        <param argument="--psm_report" type="data" format="tabular" label="PSM report"/>
        <param argument="--psm_report_1_percent" type="data" format="tabular" label="PSM report at 1% FDR" optional="true"/>
        <param argument="--input_file_type" type="select" label="PSM report">
            <option value="PSM_Report" selected="true">PSM_Report</option>
            <option value="PMD_FDR_input_file">PMD_FDR_input_file</option>
        </param>
        <param argument="--score_field_name" type="text" value="" label="PSM report">
            <validator type="empty_field"/>
            <sanitizer>
                <valid initial="string.printable">
                </valid>
            </sanitizer>
        </param>
    </inputs>
    <outputs>
        <data name="output_g_fdr" format="tabular" label="${tool.name} on ${on_string} output_g_fdr"/>
        <data name="output_i_fdr" format="tabular" label="${tool.name} on ${on_string} output_i_fdr"/>
        <data name="output_densities" format="tabular" label="${tool.name} on ${on_string} output_densities"/>
    </outputs>
    <tests>
        <test>
            <param name="psm_report" ftype="tabular" value="test_PSM_Report.tabular"/>
            <param name="score_field_name" value="Confidence [%]"/>
            <output name="output_g_fdr" file="output_g_fdr.tabular" />
            <output name="output_i_fdr" file="output_i_fdr.tabular" />
            <output name="output_densities" file="output_densities.tabular" />
        </test>
    </tests>
    <help><![CDATA[
PMD_FDR_package_for_Galaxy.R

usage: PMD_FDR_package_for_Galaxy.R [--] [--help] [--opts OPTS] [--psm_report PSM_REPORT] [--psm_report_1_percent PSM_REPORT_1_PERCENT] [--output_i_fdr OUTPUT_I_FDR] [--output_g_fdr OUTPUT_G_FDR] [--output_densities OUTPUT_DENSITIES] [--score_field_name SCORE_FIELD_NAME] [--input_file_type INPUT_FILE_TYPE]

Computes individual and global FDR using Precursor Mass Discrepancy (PMD-FDR)


flags:
  -h, --help            show this help message and exit

optional arguments:
  -x, --opts OPTS            RDS file containing argument values
  -p, --psm_report PSM_REPORT            full name and path to the PSM report
  --psm_report_1_percent PSM_REPORT_1_PERCENT            full name and path to the PSM report for 1% FDR [default: ]
  -o, --output_i_fdr OUTPUT_I_FDR            full name and path to the i-FDR output file  [default: ]
  --output_g_fdr OUTPUT_G_FDR            full name and path to the g-FDR output file  [default: ]
  --output_densities OUTPUT_DENSITIES            full name and path to the densities output file  [default: ]
  -s, --score_field_name SCORE_FIELD_NAME            name of score field (in R format) [default: ]
  -i, --input_file_type INPUT_FILE_TYPE            type of input file (currently supports: PSM_Report) [default: PMD_FDR_input_file]

    ]]></help>
</tool>
